MOre functions and nested loops